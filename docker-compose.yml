version: '2'

services:

  fpm:
    # image: iamdb/fpm-bedrock-wordpress
    build: ./fpm-wordpress
    container_name: bedrock_fpm
    external_links:
      - dev_mariadb:mariadb
    networks:
      - default
      - dev_default
    volumes:
      #- /var/www/html
      #- /mnt/docker/bedrock/data:/var/www/html
      - ../_htdocs/php_wp_sixmurs_int:/var/www/html
      - .:/home/bedrock
    ports:
      - "9000:9000"
    environment:
      DB_NAME: vti-sixmurs-int
      DB_USER: root
      DB_PASSWORD: root
      DB_HOST: mariadb
      WP_ENV: development
      WP_HOME: http://internal.sixmurs.dev
      WP_SITEURL: http://internal.sixmurs.dev/wp
      PHP_XDEBUG_ENABLED: 1 # Set 1 to enable.
      XDEBUG_CONFIG: remote_host=localhost
      # uncomment below for new installations
      #ADMIN_USER: admin
      #ADMIN_PASS: admin
      #ADMIN_EMAIL: admin@asd.com
      #SITE_TITLE: WordPress

  nginx:
    # image: iamdb/nginx-bedrock-wordpress
    build: ./nginx-wordpress
    container_name: bedrock_nginx
    links:
      - fpm:fpm
    volumes_from:
      - fpm
    ports:
      - "8000:80"
    environment:
#      uncomment below to remove installation password
      ALLOW_INSTALL: "yes"
      VIRTUAL_HOST: "internal.sixmurs.dev"
      VIRTUAL_PORT: "80"
    networks:
      - default
      - dev_default

#  caldav:
#    volumes:
#      - ../_htdocs/caldav-api:/var/www
#      - ../_htdocs/caldav-api/conf:/etc/nginx/sites-available
#    image: igez/nginx-php7.0-fpm
#    ports:
#      - "8080:80"
#    restart: always
#    container_name: bedrock_caldav
#    environment:
#      - PUBLIC=public
#    external_links:
#      - dev_mariadb:mariadb
#    networks:
#      - default
#      - dev_default

volumes:
  wordpress-db:
    driver: local

networks:
  dev_default:
    external: true
